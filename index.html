<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Feedback Form</title>
    <meta name="description" content="Team Feedback Form" />
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Custom styles for mic icon */
      .mic-icon {
        width: 16px;
        height: 16px;
        fill: none;
        stroke: currentColor;
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
      }
      
      /* Focus styles for accessibility */
      .rating-dot:focus {
        outline: 2px solid #C1272D;
        outline-offset: 2px;
      }
      
      /* Transition for submit button */
      .submit-btn {
        transition: all 0.2s ease;
      }
      
      .submit-btn:hover {
        background-color: #C1272D;
        color: white;
      }
      
      .submit-btn:hover .btn-text {
        color: white;
      }
      
      /* Textarea auto-resize */
      textarea {
        resize: none;
        overflow: hidden;
      }
    </style>
  </head>

  <body class="bg-white">
    <main class="min-h-screen bg-white">
      <div class="flex w-[1440px] flex-col items-center min-h-screen bg-white pb-10 max-md:w-full max-md:px-5 max-md:py-0 max-sm:px-[15px] max-sm:py-0 mx-auto">
        <div class="flex flex-col justify-center items-center gap-8 w-full pb-16">
          
          <!-- Header Section -->
          <header class="flex flex-col items-start gap-5 w-full bg-[#F6F6F6] px-[30px] py-16 max-md:px-5 max-md:py-10 max-sm:px-[15px] max-sm:py-[30px]">
            <h1 class="w-full text-[#28292B] text-[54px] font-bold leading-[54px] max-md:text-[42px] max-sm:text-[32px]">
              Help us improve
            </h1>
            <p class="w-full text-[#4F4F4F] text-2xl font-normal leading-[31.2px] max-md:text-xl max-sm:text-lg">
              Has your overall satisfaction with the team changed since your last
              feedback submission?
            </p>
            
            <!-- Initial Comment Input -->
            <div class="flex h-20 max-w-[800px] justify-end items-end gap-2.5 w-full rounded border bg-white p-3 border-solid border-[#B5B5B5] max-sm:h-[60px]">
              <textarea
                id="initialComment"
                placeholder="Add your comment"
                class="flex-[1_0_0] self-stretch text-[#707070] text-lg font-normal leading-6 max-sm:text-base bg-transparent border-none outline-none resize-none"
                rows="1"
                oninput="autoResize(this)"
              ></textarea>
              <button
                type="button"
                class="flex items-center justify-center w-[30px] h-[31px] rounded-[20px] bg-[#E8E8E8] flex-shrink-0"
                aria-label="Voice input"
              >
                <svg class="mic-icon">
                  <path d="m12 1-3 2 2 4 2-4-1-2z"></path>
                  <path d="M8 11a4 4 0 1 0 8 0V4a4 4 0 1 0-8 0v7z"></path>
                  <path d="m19 11-1 3-1-3"></path>
                  <path d="m5 11 1 3 1-3"></path>
                  <path d="M12 19v4"></path>
                  <path d="m4 23 16 0"></path>
                </svg>
              </button>
            </div>
            
            <p class="w-full text-[#5F5F5F] text-base font-normal leading-[20.8px]">
              *This form is used for collecting formal feedback from customers on
              a regular basis. The results of the survey will be used for
              improving the quality of our services and optimizing the work of the
              project team.
            </p>
          </header>
          
          <!-- Feedback Form -->
          <form 
            id="feedbackForm"
            class="flex flex-col justify-center items-start gap-[60px] w-full px-[30px] py-0 max-md:gap-10 max-md:px-5 max-md:py-0 max-sm:gap-[30px] max-sm:px-[15px] max-sm:py-0"
            onsubmit="handleSubmit(event)"
          >
            
            <!-- Question Template (will be populated by JavaScript) -->
            <div id="questionsContainer"></div>
            
            <!-- Submit Button -->
            <button
              type="submit"
              class="submit-btn flex w-[300px] h-[50px] justify-center items-center relative cursor-pointer px-0.5 py-[15.5px] rounded-[25px] border-2 border-solid border-[#C1272D] max-md:w-[250px] max-sm:w-[200px] max-sm:h-[45px]"
            >
              <span class="btn-text text-[#C1272D] text-[19px] font-normal leading-[19px] uppercase max-sm:text-base">
                SEND
              </span>
            </button>
          </form>
        </div>
      </div>
    </main>

    <script>
      // Questions data
      const questions = [
        "How happy are you with the current speed of the team?",
        "How would you rate the team members' skill level?",
        "Based on your experience with the team, how would you assess their independence and self-sufficiency in doing their work?",
        "How proactive is the team? Do they make valuable contributions to the project or just follow instructions?",
        "How would you rate the team's adherence to established best practices and conventions?",
        "How would you rate the quality of the team's communications?",
        "How would you rate the quality of the team's deliverables?"
      ];

      // Form data storage
      let formData = {
        initialComment: '',
        questions: questions.map(() => ({ rating: 2, comment: '' }))
      };

      // Auto-resize textarea function
      function autoResize(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = textarea.scrollHeight + 'px';
      }

      // Create rating slider component
      function createRatingSlider(questionIndex, currentRating) {
        const handleDotClick = (rating) => {
          formData.questions[questionIndex].rating = rating;
          updateRatingDisplay(questionIndex, rating);
        };

        const renderDot = (position) => {
          const isSelected = currentRating === position;
          return `
            <button
              type="button"
              onclick="handleRatingChange(${questionIndex}, ${position})"
              class="rating-dot w-6 h-6 relative focus:outline-none focus:ring-2 focus:ring-[#C1272D] focus:ring-offset-2 rounded-full"
              aria-label="Rating ${position} out of 5"
            >
              <div class="w-6 h-6 rounded-[20px] border-2 border-solid ${
                isSelected ? 'border-[#C1272D]' : 'border-[#949494]'
              }"></div>
              ${isSelected ? '<div class="w-3 h-3 rounded-full bg-[#C1272D] absolute left-1.5 top-1.5"></div>' : ''}
            </button>
          `;
        };

        const renderLine = () => '<div class="flex-1 h-0.5 bg-[#DCDCDC]"></div>';

        return `
          <div class="flex h-11 max-w-[800px] items-center gap-11 w-full max-md:gap-5 max-sm:flex-col max-sm:gap-[15px] max-sm:h-auto">
            <div class="text-black text-[17px] font-normal leading-6 max-md:text-sm max-sm:text-xs">
              NOT HAPPY AT ALL
            </div>
            <div class="flex items-center gap-4 flex-[1_0_0] max-sm:w-full max-sm:max-w-[300px]">
              ${renderDot(1)}
              ${renderLine()}
              ${renderDot(2)}
              ${renderLine()}
              ${renderDot(3)}
              ${renderLine()}
              ${renderDot(4)}
              ${renderLine()}
              ${renderDot(5)}
            </div>
            <div class="text-black text-[17px] font-normal leading-6 max-md:text-sm max-sm:text-xs">
              IT'S AMAZING!
            </div>
          </div>
        `;
      }

      // Create comment input component
      function createCommentInput(questionIndex, placeholder = "Add your comment") {
        return `
          <div class="flex h-20 max-w-[800px] justify-end items-end gap-2.5 w-full rounded border bg-white p-3 border-solid border-[#B5B5B5] max-sm:h-[60px]">
            <textarea
              id="comment-${questionIndex}"
              placeholder="${placeholder}"
              class="flex-[1_0_0] self-stretch text-[#707070] text-lg font-normal leading-6 max-sm:text-base bg-transparent border-none outline-none resize-none"
              rows="1"
              oninput="autoResize(this); handleCommentChange(${questionIndex}, this.value)"
            ></textarea>
            <button
              type="button"
              class="flex items-center justify-center w-[30px] h-[31px] rounded-[20px] bg-[#E8E8E8] flex-shrink-0"
              aria-label="Voice input"
            >
              <svg class="mic-icon">
                <path d="m12 1-3 2 2 4 2-4-1-2z"></path>
                <path d="M8 11a4 4 0 1 0 8 0V4a4 4 0 1 0-8 0v7z"></path>
                <path d="m19 11-1 3-1-3"></path>
                <path d="m5 11 1 3 1-3"></path>
                <path d="M12 19v4"></path>
                <path d="m4 23 16 0"></path>
              </svg>
            </button>
          </div>
        `;
      }

      // Create rating question component
      function createRatingQuestion(question, index) {
        return `
          <section class="flex flex-col items-start gap-5 w-full">
            <h3 class="max-w-[800px] w-full text-[#4F4F4F] text-2xl font-normal leading-[34px] max-md:text-xl max-md:leading-7 max-sm:text-lg max-sm:leading-[26px]">
              ${question}
            </h3>
            <div class="flex flex-col justify-end items-start gap-5 w-full">
              <div id="rating-slider-${index}">
                ${createRatingSlider(index, formData.questions[index].rating)}
              </div>
              ${createCommentInput(index)}
            </div>
          </section>
        `;
      }

      // Handle rating change
      function handleRatingChange(questionIndex, rating) {
        formData.questions[questionIndex].rating = rating;
        updateRatingDisplay(questionIndex, rating);
      }

      // Handle comment change
      function handleCommentChange(questionIndex, comment) {
        formData.questions[questionIndex].comment = comment;
      }

      // Update rating display
      function updateRatingDisplay(questionIndex, newRating) {
        const sliderContainer = document.getElementById(`rating-slider-${questionIndex}`);
        sliderContainer.innerHTML = createRatingSlider(questionIndex, newRating);
      }

      // Handle form submission
      function handleSubmit(event) {
        event.preventDefault();
        
        // Get initial comment
        formData.initialComment = document.getElementById('initialComment').value;
        
        // Get all comments
        questions.forEach((_, index) => {
          const commentInput = document.getElementById(`comment-${index}`);
          formData.questions[index].comment = commentInput.value;
        });
        
        console.log('Feedback submitted:', formData);
        alert('Thank you for your feedback!');
      }

      // Initialize the form
      function initializeForm() {
        const container = document.getElementById('questionsContainer');
        container.innerHTML = questions.map((question, index) => 
          createRatingQuestion(question, index)
        ).join('');

        // Set up initial comment handler
        document.getElementById('initialComment').addEventListener('input', function() {
          formData.initialComment = this.value;
          autoResize(this);
        });
      }

      // Initialize when page loads
      document.addEventListener('DOMContentLoaded', initializeForm);
    </script>
  </body>
</html>
